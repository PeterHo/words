{"version":3,"sources":["../../../src/renderer/views/layout.js"],"names":["Layout","props","globalSearch","event","preventDefault","stopPropagation","push","pathname","query","searchFileText","state","available","changeSearchFileText","setState","target","value","componentDidMount","replace","newNoteBook","patt","RegExp","test","location","Object","assign","newNote","fileParams","insert","error","newFile","emit","jQuery","findDOMNode","refs","notesLink","click","$","hasClass","trashLink","newProps","globalSearchInput","find","val","right","position","marginRight","color","children"],"mappings":"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","file":"layout.js","sourcesContent":["import React, {\n    Component\n} from 'react';\nimport {\n    Link,\n    IndexLink\n} from 'react-router';\nimport {\n    List,\n    ListItem\n} from 'material-ui/List';\nimport TextField from 'material-ui/TextField';\nimport Menu from 'material-ui/Menu';\nimport MenuItem from 'material-ui/MenuItem';\nimport {\n    hashHistory\n} from 'react-router';\nimport ReactDom from 'react-dom';\nimport { setDispatchHandler } from '../dispatch_handlers'\nimport {\n  files\n} from '../../main/set_db';\nimport singleEvent from '../single_event';\nimport { setupIpc } from '../setup_ipc';\n\nclass Layout extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchFileText: props.location.query.searchFileText || ''\n    };\n  }\n\n  globalSearch = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    hashHistory.push({ pathname: '/notes', query: {searchFileText: this.state.searchFileText, available: true}});\n  }\n\n  changeSearchFileText = (event) => {\n    this.setState({\n      searchFileText: event.target.value\n    });\n  }\n\n  // maybe not a legant way, the method break the react lifecycle!!!\n  componentWillReceiveProps(newProps) {\n    if(newProps.location.query.searchFileText != this.state.searchFileText){\n      this.setState({searchFileText: newProps.location.query.searchFileText || ''});\n      jQuery(ReactDom.findDOMNode(this.refs.globalSearchInput)).find('input').val(newProps.location.query.searchFileText || '');\n    }\n  }\n\n  componentDidMount = () => {\n    setupIpc();\n    // 配些全局的相应appmenu的event\n    setDispatchHandler('newNoteBook', () => {\n      hashHistory.replace({\n        pathname: '/',\n        query: {\n          newNoteBook: true\n        }\n      });\n    });\n    setDispatchHandler('newNote', () => {\n      let patt = new RegExp('notes');\n      if(patt.test(this.props.location.pathname)){\n        hashHistory.push({\n          pathname: this.props.location.pathname,\n          query: Object.assign({}, this.props.location.query, {available: true, newNote: true})\n        });\n      }else{\n        hashHistory.push({\n          pathname: '/notes',\n          query: {available: true, newNote: true}\n        });\n      }\n    });\n\n    //new note From tray\n    setDispatchHandler('newNoteFromTray', (fileParams) => {\n      files.insert(fileParams, (error, newFile) => {\n        singleEvent.emit('addNoteFromTray', newFile)\n      });\n    });\n\n    // hack notes和trash的相应\n    jQuery(ReactDom.findDOMNode(this.refs.notesLink)).click(function(event){\n      if($(this).hasClass('active'))\n        event.preventDefault();\n    });\n    jQuery(ReactDom.findDOMNode(this.refs.trashLink)).click(function(event){\n      if($(this).hasClass('active'))\n        event.preventDefault();\n    });\n  }\n\n  render() {\n    return (\n      <div className='body'>\n        <div className='header'>\n          <form onSubmit={this.globalSearch}>\n            <TextField\n              hintText=\"Search notes\"\n              style={{ right: '0px', position: 'absolute', marginRight: '10px' }}\n              inputStyle={{ color: 'white'}}\n              hintStyle={{ color: 'white' }}\n              defaultValue={this.state.searchFileText || ''}\n              onChange={this.changeSearchFileText}\n              ref='globalSearchInput'\n            />\n          </form>\n        </div>\n        <div className='sidebar'>\n          <div className='banner'><p>Enjoy ANOTE</p></div>\n          <ul className='s-menu main-menu'>\n            <li><IndexLink to='/' activeClassName='active'>Notebooks</IndexLink></li>\n            <li>\n              <Link\n                to={{pathname: '/notes', query: { available: true }}}\n                activeClassName='active'\n                ref='notesLink'\n              >\n                Notes\n              </Link>\n            </li>\n            <li>\n              <Link\n                to={{pathname: '/notes', query: { available: false }}}\n                activeClassName='active'\n                ref='trashLink'\n              >\n                Trash\n              </Link>\n            </li>\n            {/* <li><Link to='/test' activeClassName='active'>playstation</Link></li> */}\n          </ul>\n        </div>\n        <div className='content'>\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Layout;\n"]}