{"version":3,"sources":["../../src/main/ipc.js"],"names":["electron","require","app","Menu","MenuItem","BrowserWindow","menu","shell","mainMsgQueue","init","ipc","ipcMain","on","e","mainRenderReady","forEach","message","main","send","length","console","log","event","arg","onNotebookContainer","onEditNote","onEditTrash","onNoEditNotesList","item","enableItem","disableItem","openExternal","args","worker","win","dispatch","exports"],"mappings":"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","file":"ipc.js","sourcesContent":["const electron = require('electron');\nconst app = electron.app;\nimport windows from './windows';\nimport {log} from './log';\nconst {Menu, MenuItem} = electron;\nconst BrowserWindow = electron.BrowserWindow;\nconst menu = require('./menu');\nconst shell = require('./shell');\nimport {openSaveDialog, openFileDialog} from './dialog';\n\nvar mainMsgQueue = [];\n\nconst init = () => {\n    var ipc = electron.ipcMain;\n\n    ipc.on('mainRenderReady', function (e) {\n        app.mainRenderReady = true;\n\n        // 暂存msg的queue\n        mainMsgQueue.forEach(function (message) {\n            if (windows.main)\n                windows.main.send(...message);\n        });\n\n        mainMsgQueue.length = 0;\n        console.log('mainRenderReady ............');\n    });\n\n    ipc.on('ipcTestMain', (event, arg) => {\n        log('main prcess received the ipcTestMain');\n    });\n\n    ipc.on('onNotebookContainer', (event, arg) => {\n        menu.onNotebookContainer();\n    });\n\n    ipc.on('onEditNote', (event, arg) => {\n        menu.onEditNote();\n    });\n\n    ipc.on('onEditTrash', (event, arg) => {\n        menu.onEditTrash();\n    });\n\n    ipc.on('onNoEditNotesList', (event, arg) => {\n        menu.onNoEditNotesList();\n    });\n\n    ipc.on('enableItem', (event, item) => {\n        menu.enableItem(item);\n    });\n\n    ipc.on('disableItem', (event, item) => {\n        menu.disableItem(item);\n    });\n\n    ipc.on('openExternal', shell.openExternal);\n\n    // a bridge between main render process to worker process\n    ipc.on('workerCmd', (event, ...args) => {\n        if (windows.worker.win)\n            return windows.worker.dispatch(...args);\n        windows.worker.init(() => {\n            windows.worker.dispatch(...args);\n        });\n    });\n\n    // a bridge between other window to main\n    ipc.on('mainCmd', (event, ...args) => {\n        if (windows.main.win)\n            return windows.main.dispatch(...args);\n        windows.main.init();\n        windows.main.dispatch(...args);\n    })\n\n    // open save dialog\n    ipc.on('saveDialog', (...args) => {\n        openSaveDialog(...args);\n    });\n\n    ipc.on('openFile', (...args) => {\n        openFileDialog(...args);\n    });\n}\n\nexports.mainMsgQueue = mainMsgQueue;\nexports.init = init;\n"]}