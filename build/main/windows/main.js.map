{"version":3,"sources":["../../../src/main/windows/main.js"],"names":["main","module","exports","init","show","hide","send","dispatch","win","electron","require","app","BrowserWindow","path","menu","width","height","darkTheme","name","backgroundColor","once","enableItem","loadURL","resolve","__dirname","on","length","mainRenderReady","onNoMainWin","args","push"],"mappings":";;AAiBA;;AAjBA,IAAIA,OAAOC,OAAOC,OAAP,GAAiB;AACxBC,cADwB;AAExBC,cAFwB;AAGxBC,cAHwB;AAIxBC,cAJwB;AAKxBC,sBALwB;AAMxBC,SAAK;AANmB,CAA5B;;AASA,IAAMC,WAAWC,QAAQ,UAAR,CAAjB;;AAEA,IAAMC,MAAMF,SAASE,GAArB;;AAEA,IAAMC,gBAAgBH,SAASG,aAA/B;;AAEA,IAAMC,OAAOH,QAAQ,MAAR,CAAb;;AAIA,IAAMI,OAAOJ,QAAQ,SAAR,CAAb;;AAEA,SAASP,IAAT,GAAgB;AACZ,QAAIH,KAAKQ,GAAT,EAAc;AACV,eAAOR,KAAKQ,GAAL,CAASJ,IAAT,EAAP;AACH;;AAED,QAAII,MAAMR,KAAKQ,GAAL,GAAW,IAAII,aAAJ,CAAkB;AACnCG,eAAO,IAD4B;AAEnCC,gBAAQ,GAF2B;AAGnCC,mBAAW,IAHwB;AAInCC,cAAM,OAJ6B;AAKnCC,yBAAiB,MALkB;AAMnCf,cAAM;AAN6B,KAAlB,CAArB;;AASAI,QAAIY,IAAJ,CAAS,eAAT,EAA0B,YAAM;AAC5BhB;AACAU,aAAKO,UAAL,CAAgB,cAAhB;AACH,KAHD;;AAKA;AACAb,QAAIc,OAAJ,aAAsBT,KAAKU,OAAL,CAAaC,SAAb,EAAwB,2BAAxB,CAAtB;;AAEA;AACA;;AAEA;AACAhB,QAAIiB,EAAJ,CAAO,QAAP,EAAiB,YAAY;AACzBjB,cAAMR,KAAKQ,GAAL,GAAW,IAAjB;AACA,0BAAakB,MAAb,GAAsB,CAAtB;AACAf,YAAIgB,eAAJ,GAAsB,KAAtB;AACAb,aAAKc,WAAL;AACH,KALD;AAMH;;AAED,SAASxB,IAAT,GAAgB;AACZ,QAAI,CAACJ,KAAKQ,GAAV,EACI;AACJR,SAAKQ,GAAL,CAASJ,IAAT;AACH;;AAED,SAASC,IAAT,GAAgB;AACZ,QAAI,CAACL,KAAKQ,GAAV,EACI;AACJR,SAAKQ,GAAL,CAASH,IAAT;AACH;;AAED,SAASC,IAAT,GAAuB;AAAA,sCAANuB,IAAM;AAANA,YAAM;AAAA;;AACnB,QAAI,CAAC7B,KAAKQ,GAAN,IAAa,CAACG,IAAIgB,eAAtB,EAAuC;AACnC,0BAAaG,IAAb,CAAkBD,IAAlB;AACH,KAFD,MAEO;AAAA;;AACH,0BAAKrB,GAAL,EAASF,IAAT,kBAAiBuB,IAAjB;AACH;AACJ;;AAED;AACA;AACA,SAAStB,QAAT,GAA2B;AAAA,uCAANsB,IAAM;AAANA,YAAM;AAAA;;AACvBvB,2BAAK,UAAL,SAAoBuB,IAApB;AACH","file":"main.js","sourcesContent":["var main = module.exports = {\n    init,\n    show,\n    hide,\n    send,\n    dispatch,\n    win: null\n};\n\nconst electron = require('electron')\n\nconst app = electron.app\n\nconst BrowserWindow = electron.BrowserWindow\n\nconst path = require('path')\n\nimport {mainMsgQueue} from '../ipc.js';\n\nconst menu = require('../menu');\n\nfunction init() {\n    if (main.win) {\n        return main.win.show();\n    }\n\n    var win = main.win = new BrowserWindow({\n        width: 1000,\n        height: 800,\n        darkTheme: true,\n        name: 'ANOTE',\n        backgroundColor: '#eee',\n        show: false,\n    });\n\n    win.once('ready-to-show', () => {\n        show();\n        menu.enableItem('New Notebook');\n    });\n\n    // and load the index.html of the app.\n    win.loadURL(`file://${path.resolve(__dirname, '../../../static/main.html')}`)\n\n    // Open the DevTools.\n    // win.webContents.openDevTools();\n\n    // Emitted when the window is closed.\n    win.on('closed', function () {\n        win = main.win = null;\n        mainMsgQueue.length = 0;\n        app.mainRenderReady = false;\n        menu.onNoMainWin();\n    })\n}\n\nfunction show() {\n    if (!main.win)\n        return;\n    main.win.show();\n}\n\nfunction hide() {\n    if (!main.win)\n        return;\n    main.win.hide();\n}\n\nfunction send(...args) {\n    if (!main.win || !app.mainRenderReady) {\n        mainMsgQueue.push(args);\n    } else {\n        main.win.send(...args);\n    }\n}\n\n// dispath a event to render process\n// 处于给render process 发送事件dispatch，并且处理.\nfunction dispatch(...args) {\n    send('dispatch', ...args);\n}\n"]}