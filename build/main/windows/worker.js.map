{"version":3,"sources":["../../../src/main/windows/worker.js"],"names":["worker","module","exports","win","init","send","dispatch","electron","require","BrowserWindow","path","callback","width","height","show","loadURL","resolve","__dirname","on","webContents","once","args"],"mappings":";;AAAA,IAAIA,SAASC,OAAOC,OAAP,GAAiB;AAC1BC,SAAK,IADqB;AAE1BC,cAF0B;AAG1BC,cAH0B;AAI1BC;AAJ0B,CAA9B;;AAOA;AACA,IAAMC,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAMC,gBAAgBF,SAASE,aAA/B;AACA,IAAMC,OAAOF,QAAQ,MAAR,CAAb;;AAEA,SAASJ,IAAT,CAAcO,QAAd,EAAwB;AACpB,QAAIX,OAAOG,GAAX,EACI;AACJH,WAAOG,GAAP,GAAa,IAAIM,aAAJ,CAAkB;AAC3BG,eAAO,CADoB;AAE3BC,gBAAQ,CAFmB;AAG3BC,cAAM;AAHqB,KAAlB,CAAb;;AAMAd,WAAOG,GAAP,CAAWY,OAAX,aAA6BL,KAAKM,OAAL,CAAaC,SAAb,EAAwB,6BAAxB,CAA7B;;AAEAjB,WAAOG,GAAP,CAAWe,EAAX,CAAc,QAAd,EAAwB,YAAY;AAChClB,eAAOG,GAAP,GAAa,IAAb;AACH,KAFD;;AAIA;AACA,QAAIQ,QAAJ,EAAc;AACVX,eAAOG,GAAP,CAAWgB,WAAX,CAAuBC,IAAvB,CAA4B,iBAA5B,EAA+C,YAAM;AACjDT;AACH,SAFD;AAGH;AACJ;;AAED,SAASN,IAAT,GAAuB;AAAA;;AACnB,QAAIL,OAAOG,GAAX,EACI,sBAAOA,GAAP,EAAWE,IAAX;AACP;;AAED,SAASC,QAAT,GAA2B;AAAA,sCAANe,IAAM;AAANA,YAAM;AAAA;;AACvBhB,2BAAK,UAAL,SAAoBgB,IAApB;AACH","file":"worker.js","sourcesContent":["var worker = module.exports = {\n    win: null,\n    init,\n    send,\n    dispatch\n};\n\n// 做后台工作的invisible window\nconst electron = require('electron');\nconst BrowserWindow = electron.BrowserWindow;\nconst path = require('path');\n\nfunction init(callback) {\n    if (worker.win)\n        return;\n    worker.win = new BrowserWindow({\n        width: 0,\n        height: 0,\n        show: false\n    });\n\n    worker.win.loadURL(`file://${path.resolve(__dirname, '../../../static/worker.html')}`);\n\n    worker.win.on('closed', function () {\n        worker.win = null;\n    })\n\n    // 确保worker是开着的, 因为main window的reload会使得worker经常死掉\n    if (callback) {\n        worker.win.webContents.once('did-finish-load', () => {\n            callback();\n        })\n    }\n}\n\nfunction send(...args) {\n    if (worker.win)\n        worker.win.send(...args);\n}\n\nfunction dispatch(...args) {\n    send('dispatch', ...args);\n}\n"]}